<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Yang Kang Chua, Shen, Tong">
<meta name="dcterms.date" content="2023-03-03">

<title>Midterm Project</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="Midterm_Project_files/libs/clipboard/clipboard.min.js"></script>
<script src="Midterm_Project_files/libs/quarto-html/quarto.js"></script>
<script src="Midterm_Project_files/libs/quarto-html/popper.min.js"></script>
<script src="Midterm_Project_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Midterm_Project_files/libs/quarto-html/anchor.min.js"></script>
<link href="Midterm_Project_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Midterm_Project_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Midterm_Project_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Midterm_Project_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Midterm_Project_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Midterm Project</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Yang Kang Chua, Shen, Tong </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 3, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<div class="cell" data-execution_count="1">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>nyc311 <span class="op">=</span> pd.read_csv(<span class="st">"nyc311_011523-012123_by022023.csv"</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>nyc311.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="25">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Unique Key</th>
      <th>Created Date</th>
      <th>Closed Date</th>
      <th>Agency</th>
      <th>Agency Name</th>
      <th>Complaint Type</th>
      <th>Descriptor</th>
      <th>Location Type</th>
      <th>Incident Zip</th>
      <th>Incident Address</th>
      <th>...</th>
      <th>Vehicle Type</th>
      <th>Taxi Company Borough</th>
      <th>Taxi Pick Up Location</th>
      <th>Bridge Highway Name</th>
      <th>Bridge Highway Direction</th>
      <th>Road Ramp</th>
      <th>Bridge Highway Segment</th>
      <th>Latitude</th>
      <th>Longitude</th>
      <th>Location</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>56532399</td>
      <td>01/15/2023 12:00:00 AM</td>
      <td>01/17/2023 12:00:01 AM</td>
      <td>DOHMH</td>
      <td>Department of Health and Mental Hygiene</td>
      <td>Food Poisoning</td>
      <td>1 or 2</td>
      <td>Restaurant/Bar/Deli/Bakery</td>
      <td>11101.0</td>
      <td>28-07 JACKSON AVENUE</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>40.748433</td>
      <td>-73.938768</td>
      <td>(40.74843329250923, -73.93876844606294)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>56533302</td>
      <td>01/15/2023 12:00:00 AM</td>
      <td>01/23/2023 12:00:01 AM</td>
      <td>DOHMH</td>
      <td>Department of Health and Mental Hygiene</td>
      <td>Food Poisoning</td>
      <td>1 or 2</td>
      <td>Other (Explain Below)</td>
      <td>11101.0</td>
      <td>48-18 NORTHERN BOULEVARD</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>40.753619</td>
      <td>-73.914245</td>
      <td>(40.75361894380833, -73.91424532268624)</td>
    </tr>
    <tr>
      <th>2</th>
      <td>56533451</td>
      <td>01/15/2023 12:00:00 AM</td>
      <td>01/17/2023 09:34:08 AM</td>
      <td>DOHMH</td>
      <td>Department of Health and Mental Hygiene</td>
      <td>Food Poisoning</td>
      <td>1 or 2</td>
      <td>Food Cart Vendor</td>
      <td>10305.0</td>
      <td>1941 HYLAN BOULEVARD</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>40.582218</td>
      <td>-74.097217</td>
      <td>(40.58221767593629, -74.09721689751461)</td>
    </tr>
    <tr>
      <th>3</th>
      <td>56536021</td>
      <td>01/15/2023 12:00:00 AM</td>
      <td>01/17/2023 09:48:19 AM</td>
      <td>DOHMH</td>
      <td>Department of Health and Mental Hygiene</td>
      <td>Food Poisoning</td>
      <td>1 or 2</td>
      <td>Restaurant/Bar/Deli/Bakery</td>
      <td>11103.0</td>
      <td>24-11 STEINWAY STREET</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>40.768674</td>
      <td>-73.911074</td>
      <td>(40.76867420855789, -73.91107425623979)</td>
    </tr>
    <tr>
      <th>4</th>
      <td>56538004</td>
      <td>01/15/2023 12:00:00 AM</td>
      <td>01/23/2023 03:08:02 PM</td>
      <td>DOHMH</td>
      <td>Department of Health and Mental Hygiene</td>
      <td>Food Poisoning</td>
      <td>3 or More</td>
      <td>Other (Explain Below)</td>
      <td>10036.0</td>
      <td>700 8 AVENUE</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>40.758662</td>
      <td>-73.988738</td>
      <td>(40.75866221848322, -73.98873795996684)</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 41 columns</p>
</div>
</div>
</div>
<p>Get a statistical summary</p>
<div class="cell" data-execution_count="2">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>nyc311.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="26">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Unique Key</th>
      <th>Incident Zip</th>
      <th>BBL</th>
      <th>X Coordinate (State Plane)</th>
      <th>Y Coordinate (State Plane)</th>
      <th>Latitude</th>
      <th>Longitude</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>5.446900e+04</td>
      <td>53720.000000</td>
      <td>4.824400e+04</td>
      <td>5.349500e+04</td>
      <td>53526.000000</td>
      <td>53491.000000</td>
      <td>53491.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>5.656144e+07</td>
      <td>10807.120514</td>
      <td>2.695698e+09</td>
      <td>1.005072e+06</td>
      <td>207697.450342</td>
      <td>40.736701</td>
      <td>-73.924827</td>
    </tr>
    <tr>
      <th>std</th>
      <td>1.854674e+04</td>
      <td>534.867544</td>
      <td>1.148508e+09</td>
      <td>2.094108e+04</td>
      <td>32076.816492</td>
      <td>0.088046</td>
      <td>0.075525</td>
    </tr>
    <tr>
      <th>min</th>
      <td>5.652417e+07</td>
      <td>10000.000000</td>
      <td>0.000000e+00</td>
      <td>9.140500e+05</td>
      <td>121152.000000</td>
      <td>40.498949</td>
      <td>-74.252452</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>5.654532e+07</td>
      <td>10451.000000</td>
      <td>2.027820e+09</td>
      <td>9.934695e+05</td>
      <td>183297.000000</td>
      <td>40.669735</td>
      <td>-73.966757</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>5.656131e+07</td>
      <td>11201.000000</td>
      <td>3.016035e+09</td>
      <td>1.004174e+06</td>
      <td>205608.500000</td>
      <td>40.730943</td>
      <td>-73.928097</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>5.657678e+07</td>
      <td>11232.000000</td>
      <td>4.000588e+09</td>
      <td>1.017478e+06</td>
      <td>237620.000000</td>
      <td>40.818878</td>
      <td>-73.880081</td>
    </tr>
    <tr>
      <th>max</th>
      <td>5.663566e+07</td>
      <td>12345.000000</td>
      <td>5.200430e+09</td>
      <td>1.067177e+06</td>
      <td>271730.000000</td>
      <td>40.912468</td>
      <td>-73.700743</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Looks good! Lets take a look at the number of missing values.</p>
<div class="cell" data-execution_count="3">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>nyc311.isna().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>Unique Key                            0
Created Date                          0
Closed Date                        5176
Agency                                0
Agency Name                           0
Complaint Type                        0
Descriptor                          888
Location Type                      7388
Incident Zip                        749
Incident Address                   2584
Street Name                        2584
Cross Street 1                    19476
Cross Street 2                    19476
Intersection Street 1             21779
Intersection Street 2             21739
Address Type                        412
City                               2375
Landmark                          25674
Facility Type                     54185
Status                                0
Due Date                          54365
Resolution Description             1751
Resolution Action Updated Date     1705
Community Board                       0
BBL                                6225
Borough                               0
X Coordinate (State Plane)          974
Y Coordinate (State Plane)          943
Open Data Channel Type                0
Park Facility Name                    9
Park Borough                          0
Vehicle Type                      54460
Taxi Company Borough              54439
Taxi Pick Up Location             53900
Bridge Highway Name               54126
Bridge Highway Direction          54290
Road Ramp                         54334
Bridge Highway Segment            54126
Latitude                            978
Longitude                           978
Location                            978
dtype: int64</code></pre>
</div>
</div>
<p>Get the type of the data frame</p>
<div class="cell" data-execution_count="4">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>nyc311.info()<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 54469 entries, 0 to 54468
Data columns (total 41 columns):
 #   Column                          Non-Null Count  Dtype  
---  ------                          --------------  -----  
 0   Unique Key                      54469 non-null  int64  
 1   Created Date                    54469 non-null  object 
 2   Closed Date                     49293 non-null  object 
 3   Agency                          54469 non-null  object 
 4   Agency Name                     54469 non-null  object 
 5   Complaint Type                  54469 non-null  object 
 6   Descriptor                      53581 non-null  object 
 7   Location Type                   47081 non-null  object 
 8   Incident Zip                    53720 non-null  float64
 9   Incident Address                51885 non-null  object 
 10  Street Name                     51885 non-null  object 
 11  Cross Street 1                  34993 non-null  object 
 12  Cross Street 2                  34993 non-null  object 
 13  Intersection Street 1           32690 non-null  object 
 14  Intersection Street 2           32730 non-null  object 
 15  Address Type                    54057 non-null  object 
 16  City                            52094 non-null  object 
 17  Landmark                        28795 non-null  object 
 18  Facility Type                   284 non-null    object 
 19  Status                          54469 non-null  object 
 20  Due Date                        104 non-null    object 
 21  Resolution Description          52718 non-null  object 
 22  Resolution Action Updated Date  52764 non-null  object 
 23  Community Board                 54469 non-null  object 
 24  BBL                             48244 non-null  float64
 25  Borough                         54469 non-null  object 
 26  X Coordinate (State Plane)      53495 non-null  float64
 27  Y Coordinate (State Plane)      53526 non-null  float64
 28  Open Data Channel Type          54469 non-null  object 
 29  Park Facility Name              54460 non-null  object 
 30  Park Borough                    54469 non-null  object 
 31  Vehicle Type                    9 non-null      object 
 32  Taxi Company Borough            30 non-null     object 
 33  Taxi Pick Up Location           569 non-null    object 
 34  Bridge Highway Name             343 non-null    object 
 35  Bridge Highway Direction        179 non-null    object 
 36  Road Ramp                       135 non-null    object 
 37  Bridge Highway Segment          343 non-null    object 
 38  Latitude                        53491 non-null  float64
 39  Longitude                       53491 non-null  float64
 40  Location                        53491 non-null  object 
dtypes: float64(6), int64(1), object(34)
memory usage: 17.0+ MB</code></pre>
</div>
</div>
<p>Convert the time to date time format.</p>
<div class="cell" data-execution_count="5">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>nyc311[<span class="st">'Created Date'</span>] <span class="op">=</span> pd.to_datetime(nyc311[<span class="st">'Created Date'</span>], errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>nyc311[<span class="st">'Closed Date'</span>] <span class="op">=</span> pd.to_datetime(nyc311[<span class="st">'Closed Date'</span>], errors<span class="op">=</span><span class="st">'coerce'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Let take a look on if <code>Closed Date</code> earlier than <code>Created Date</code>.</p>
<div class="cell" data-execution_count="6">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a filter to find if the Closed Date is earlier and Created Date</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>Filter_1 <span class="op">=</span> nyc311[nyc311[<span class="st">'Created Date'</span>] <span class="op">&gt;</span> nyc311[<span class="st">'Closed Date'</span>]]</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>Filter_1.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="30">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Unique Key</th>
      <th>Created Date</th>
      <th>Closed Date</th>
      <th>Agency</th>
      <th>Agency Name</th>
      <th>Complaint Type</th>
      <th>Descriptor</th>
      <th>Location Type</th>
      <th>Incident Zip</th>
      <th>Incident Address</th>
      <th>...</th>
      <th>Vehicle Type</th>
      <th>Taxi Company Borough</th>
      <th>Taxi Pick Up Location</th>
      <th>Bridge Highway Name</th>
      <th>Bridge Highway Direction</th>
      <th>Road Ramp</th>
      <th>Bridge Highway Segment</th>
      <th>Latitude</th>
      <th>Longitude</th>
      <th>Location</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>15759</th>
      <td>56545596</td>
      <td>2023-01-17 09:13:00</td>
      <td>2023-01-16 09:12:00</td>
      <td>DOT</td>
      <td>Department of Transportation</td>
      <td>Street Light Condition</td>
      <td>Fixture/Luminaire Door Open</td>
      <td>NaN</td>
      <td>10470.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>40.902160</td>
      <td>-73.847620</td>
      <td>(40.902160080380305, -73.8476196608694)</td>
    </tr>
    <tr>
      <th>16346</th>
      <td>56548261</td>
      <td>2023-01-17 10:14:00</td>
      <td>2023-01-16 09:37:00</td>
      <td>DOT</td>
      <td>Department of Transportation</td>
      <td>Street Light Condition</td>
      <td>Street Light Out</td>
      <td>NaN</td>
      <td>10470.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>40.903481</td>
      <td>-73.850341</td>
      <td>(40.903481086856935, -73.85034060870207)</td>
    </tr>
    <tr>
      <th>16374</th>
      <td>56546592</td>
      <td>2023-01-17 10:16:00</td>
      <td>2023-01-16 10:15:00</td>
      <td>DOT</td>
      <td>Department of Transportation</td>
      <td>Street Light Condition</td>
      <td>Street Light Out</td>
      <td>NaN</td>
      <td>10470.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>40.900852</td>
      <td>-73.854879</td>
      <td>(40.90085198617899, -73.85487907500377)</td>
    </tr>
    <tr>
      <th>16392</th>
      <td>56552546</td>
      <td>2023-01-17 10:18:00</td>
      <td>2023-01-16 10:17:00</td>
      <td>DOT</td>
      <td>Department of Transportation</td>
      <td>Street Light Condition</td>
      <td>Fixture/Luminaire Out Of Position</td>
      <td>NaN</td>
      <td>10459.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>40.832403</td>
      <td>-73.890717</td>
      <td>(40.83240302209445, -73.890716609599)</td>
    </tr>
    <tr>
      <th>16544</th>
      <td>56549764</td>
      <td>2023-01-17 10:28:00</td>
      <td>2023-01-16 10:27:00</td>
      <td>DOT</td>
      <td>Department of Transportation</td>
      <td>Street Light Condition</td>
      <td>Fixture/Luminaire Hanging</td>
      <td>NaN</td>
      <td>10457.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>40.847081</td>
      <td>-73.886695</td>
      <td>(40.84708060167133, -73.88669493748064)</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 41 columns</p>
</div>
</div>
</div>
<p>Few thing we can do to clean the data:</p>
<ul>
<li>Reorganize the <code>Created Date</code> and <code>Closed Date</code>.</li>
<li>Missing Value from <code>Incident Zip</code> can be found using <code>Latitude</code> and <code>Longitude</code> using <code>uszipcode</code>.</li>
<li><code>Latitude</code> and <code>Longitude</code> can be found using the available <code>Incident Address</code>, <code>Street Name</code>, <code>Cross Street 1</code>, <code>Cross Street 2</code>, <code>Intersection Street 1</code>, <code>Intersection Street 2</code> or as known as <code>Address Type</code>.</li>
<li>We can get <code>X Coordinate (State Plane)</code>and <code>Y Coordinate (State Plane)</code> using <code>stateplane</code>.</li>
<li>Update <code>Borough</code> from <code>Incident Zip</code>.</li>
</ul>
<p>Begin by Reorganize the <code>Created Date</code> and <code>Closed Date</code>.</p>
<div class="cell" data-execution_count="7">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a copy of a Closed Date(Created Date)</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>Created_Date <span class="op">=</span> Filter_1[<span class="st">'Closed Date'</span>].copy()</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> index <span class="kw">in</span> Filter_1.index:</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    Filter_1.loc[index,[<span class="st">'Closed Date'</span>]] <span class="op">=</span> Filter_1[<span class="st">'Created Date'</span>][index]</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    Filter_1.loc[index,[<span class="st">'Created Date'</span>]] <span class="op">=</span> Created_Date[index]</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>Filter_1.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="31">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Unique Key</th>
      <th>Created Date</th>
      <th>Closed Date</th>
      <th>Agency</th>
      <th>Agency Name</th>
      <th>Complaint Type</th>
      <th>Descriptor</th>
      <th>Location Type</th>
      <th>Incident Zip</th>
      <th>Incident Address</th>
      <th>...</th>
      <th>Vehicle Type</th>
      <th>Taxi Company Borough</th>
      <th>Taxi Pick Up Location</th>
      <th>Bridge Highway Name</th>
      <th>Bridge Highway Direction</th>
      <th>Road Ramp</th>
      <th>Bridge Highway Segment</th>
      <th>Latitude</th>
      <th>Longitude</th>
      <th>Location</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>15759</th>
      <td>56545596</td>
      <td>2023-01-16 09:12:00</td>
      <td>2023-01-17 09:13:00</td>
      <td>DOT</td>
      <td>Department of Transportation</td>
      <td>Street Light Condition</td>
      <td>Fixture/Luminaire Door Open</td>
      <td>NaN</td>
      <td>10470.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>40.902160</td>
      <td>-73.847620</td>
      <td>(40.902160080380305, -73.8476196608694)</td>
    </tr>
    <tr>
      <th>16346</th>
      <td>56548261</td>
      <td>2023-01-16 09:37:00</td>
      <td>2023-01-17 10:14:00</td>
      <td>DOT</td>
      <td>Department of Transportation</td>
      <td>Street Light Condition</td>
      <td>Street Light Out</td>
      <td>NaN</td>
      <td>10470.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>40.903481</td>
      <td>-73.850341</td>
      <td>(40.903481086856935, -73.85034060870207)</td>
    </tr>
    <tr>
      <th>16374</th>
      <td>56546592</td>
      <td>2023-01-16 10:15:00</td>
      <td>2023-01-17 10:16:00</td>
      <td>DOT</td>
      <td>Department of Transportation</td>
      <td>Street Light Condition</td>
      <td>Street Light Out</td>
      <td>NaN</td>
      <td>10470.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>40.900852</td>
      <td>-73.854879</td>
      <td>(40.90085198617899, -73.85487907500377)</td>
    </tr>
    <tr>
      <th>16392</th>
      <td>56552546</td>
      <td>2023-01-16 10:17:00</td>
      <td>2023-01-17 10:18:00</td>
      <td>DOT</td>
      <td>Department of Transportation</td>
      <td>Street Light Condition</td>
      <td>Fixture/Luminaire Out Of Position</td>
      <td>NaN</td>
      <td>10459.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>40.832403</td>
      <td>-73.890717</td>
      <td>(40.83240302209445, -73.890716609599)</td>
    </tr>
    <tr>
      <th>16544</th>
      <td>56549764</td>
      <td>2023-01-16 10:27:00</td>
      <td>2023-01-17 10:28:00</td>
      <td>DOT</td>
      <td>Department of Transportation</td>
      <td>Street Light Condition</td>
      <td>Fixture/Luminaire Hanging</td>
      <td>NaN</td>
      <td>10457.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>40.847081</td>
      <td>-73.886695</td>
      <td>(40.84708060167133, -73.88669493748064)</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 41 columns</p>
</div>
</div>
</div>
<p>Put into the original data.</p>
<div class="cell" data-execution_count="8">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> index <span class="kw">in</span> Filter_1.index:</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  nyc311.loc[index,[<span class="st">'Created Date'</span>]] <span class="op">=</span> Filter_1[<span class="st">'Created Date'</span>][index]</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  nyc311.loc[index,[<span class="st">'Closed Date'</span>]]  <span class="op">=</span> Filter_1[<span class="st">'Closed Date'</span>][index]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Now work on getting <code>Latitude</code> and <code>Longitude</code> can be found using the available <code>Incident Address</code>, <code>Street Name</code>, <code>Cross Street 1</code>, <code>Cross Street 2</code>, <code>Intersection Street 1</code>, <code>Intersection Street 2</code> or as known as <code>Address Type</code>.</p>
<div class="cell" data-execution_count="9">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a Filter that Latitude and Lognitude is null. We can find one of them because if Latitude is null, Longitude is also null.</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>Filter_1 <span class="op">=</span> nyc311[nyc311[<span class="st">'Latitude'</span>].isnull()]</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Most of them have zipcode we can get latitude and logitude from uszipcode</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>Filter_1 <span class="op">=</span> Filter_1[Filter_1[<span class="st">'Incident Zip'</span>].notnull()]</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> uszipcode <span class="im">import</span> SearchEngine</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a SearchEngine object</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>search <span class="op">=</span> SearchEngine()</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Create a series of Incident Zipcode from the Filter_1</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>Filter_1_series <span class="op">=</span> Filter_1[<span class="st">'Incident Zip'</span>]</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="co">#Convert into int then into string</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>Filter_1_series <span class="op">=</span> Filter_1_series.astype(<span class="bu">int</span>)</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>Filter_1_series <span class="op">=</span> Filter_1_series.astype(<span class="bu">str</span>)</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> index <span class="kw">in</span> Filter_1_series.index:</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get the zipcode from the value</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>  zipcode <span class="op">=</span> search.by_zipcode(Filter_1_series[index])</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get the latitude and longitude of from the zipcode</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>  Filter_1.loc[index,<span class="st">'Latitude'</span>] <span class="op">=</span> zipcode.lat</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>  Filter_1.loc[index,<span class="st">'Longitude'</span>] <span class="op">=</span> zipcode.lng</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a><span class="co">#Update the dataset</span></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> index <span class="kw">in</span> Filter_1.index:</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>    nyc311.loc[index,<span class="st">'Latitude'</span>]   <span class="op">=</span> Filter_1[<span class="st">'Latitude'</span>][index]</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>    nyc311.loc[index,<span class="st">'Loingitude'</span>] <span class="op">=</span> Filter_1[<span class="st">'Longitude'</span>][index]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>These are the remaining data without <code>Latitude</code> and <code>Longitude</code>. We can start with working with intersection.</p>
<div class="cell" data-execution_count="10">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the remaining data that is missing with Latitude</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>Filter_1 <span class="op">=</span> nyc311[nyc311[<span class="st">'Latitude'</span>].isnull()]</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># # Get the data that contain INTERSECTION</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>Filter_1 <span class="op">=</span> Filter_1[Filter_1[<span class="st">'Address Type'</span>] <span class="op">==</span><span class="st">'INTERSECTION'</span>]</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> geopy.geocoders <span class="im">import</span> Nominatim</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> geopy.geocoders <span class="im">import</span> GoogleV3</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> geopy.extra.rate_limiter <span class="im">import</span> RateLimiter</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>Intersection <span class="op">=</span> Filter_1[<span class="st">'Intersection Street 1'</span>] <span class="op">+</span> <span class="st">' @ '</span> <span class="op">+</span> Filter_1[<span class="st">'Intersection Street 2'</span>] <span class="op">+</span> <span class="st">' NY'</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> index <span class="kw">in</span> Intersection.index:</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    geocode <span class="op">=</span> RateLimiter(GoogleV3(api_key<span class="op">=</span><span class="st">'AIzaSyDhsJ5roz0w0ll0YegLJZn-niSBjm1ns5A'</span>).geocode, min_delay_seconds<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    location <span class="op">=</span> geocode(Intersection[index], timeout <span class="op">=</span> <span class="dv">10</span>)</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> location <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>        Filter_1.loc[index,[<span class="st">'Latitude'</span>,<span class="st">"Longitude"</span>]] <span class="op">=</span> [location.latitude,location.longitude]</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Update the data</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> index <span class="kw">in</span> Filter_1.index:</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    nyc311.loc[index,<span class="st">'Latitude'</span>]   <span class="op">=</span> Filter_1[<span class="st">'Latitude'</span>][index]</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>    nyc311.loc[index,<span class="st">'Longitude'</span>] <span class="op">=</span> Filter_1[<span class="st">'Longitude'</span>][index]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Work with address type <code>BLOCKFACE</code>.</p>
<div class="cell" data-execution_count="11">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>Filter_1 <span class="op">=</span> nyc311[nyc311[<span class="st">'Latitude'</span>].isnull()]</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>Filter_1 <span class="op">=</span> Filter_1[Filter_1[<span class="st">'Address Type'</span>] <span class="op">==</span> <span class="st">'BLOCKFACE'</span>]</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>Cross_Street <span class="op">=</span> Filter_1[<span class="st">'Cross Street 1'</span>] <span class="op">+</span> <span class="st">' @ '</span> <span class="op">+</span> Filter_1[<span class="st">'Cross Street 2'</span>] <span class="op">+</span> <span class="st">' NY '</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> index <span class="kw">in</span> Cross_Street.index:</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> Filter_1[<span class="st">'Cross Street 1'</span>][index] <span class="op">==</span> Filter_1[<span class="st">'Cross Street 2'</span>][index]:</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> Filter_1[<span class="st">'Cross Street 2'</span>][index] <span class="kw">is</span> <span class="kw">not</span> np.nan:</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> Filter_1[<span class="st">'Cross Street 2'</span>][index] <span class="op">!=</span> <span class="st">'SEE COMMENTS FOR CROSS ST'</span>:</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>                geocode <span class="op">=</span> RateLimiter(GoogleV3(api_key<span class="op">=</span><span class="st">'AIzaSyDhsJ5roz0w0ll0YegLJZn-niSBjm1ns5A'</span>).geocode, min_delay_seconds<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>                location <span class="op">=</span> geocode(Cross_Street[index], timeout <span class="op">=</span> <span class="dv">10</span>)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> location <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>                    Filter_1.loc[index,[<span class="st">'Latitude'</span>,<span class="st">"Longitude"</span>]] <span class="op">=</span> [location.latitude,location.longitude]</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the Street Name and Cross Street 1 to get the latitude and longitude</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>Filter_2 <span class="op">=</span> Filter_1[Filter_1[<span class="st">'Latitude'</span>].isnull()]</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>Street_Cross <span class="op">=</span> Filter_2[<span class="st">'Street Name'</span>] <span class="op">+</span> <span class="st">' @ '</span> <span class="op">+</span> Filter_2[<span class="st">'Cross Street 1'</span>] <span class="op">+</span> <span class="st">' NY '</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> index <span class="kw">in</span> Street_Cross.index:</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>    geocode <span class="op">=</span> RateLimiter(GoogleV3(api_key<span class="op">=</span><span class="st">'AIzaSyDhsJ5roz0w0ll0YegLJZn-niSBjm1ns5A'</span>).geocode, min_delay_seconds<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>    location <span class="op">=</span> geocode(Street_Cross[index], timeout <span class="op">=</span> <span class="dv">10</span>)</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> location <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>        Filter_1.loc[index,[<span class="st">'Latitude'</span>,<span class="st">"Longitude"</span>]] <span class="op">=</span> [location.latitude,location.longitude]</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> index <span class="kw">in</span> Filter_1.index:</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>    nyc311.loc[index,<span class="st">'Latitude'</span>]   <span class="op">=</span> Filter_1[<span class="st">'Latitude'</span>][index]</span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>    nyc311.loc[index,<span class="st">'Longitude'</span>] <span class="op">=</span> Filter_1[<span class="st">'Longitude'</span>][index]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Work on Address Type = <code>ADDRESS</code></p>
<div class="cell" data-execution_count="12">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>Filter_1 <span class="op">=</span> nyc311[nyc311[<span class="st">'Latitude'</span>].isnull()]</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>Filter_1 <span class="op">=</span> Filter_1[Filter_1[<span class="st">'Address Type'</span>] <span class="op">==</span> <span class="st">'ADDRESS'</span>]</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>Address <span class="op">=</span> Filter_1[<span class="st">'Incident Address'</span>] <span class="op">+</span> <span class="st">' NY '</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> index <span class="kw">in</span> Address.index:</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    geocode <span class="op">=</span> RateLimiter(GoogleV3(api_key<span class="op">=</span><span class="st">'AIzaSyDhsJ5roz0w0ll0YegLJZn-niSBjm1ns5A'</span>).geocode, min_delay_seconds<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    location <span class="op">=</span> geocode(Address[index], timeout <span class="op">=</span> <span class="dv">10</span>)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> location <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>        Filter_1.loc[index,[<span class="st">'Latitude'</span>,<span class="st">"Longitude"</span>]] <span class="op">=</span> [location.latitude,location.longitude]</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Update</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> index <span class="kw">in</span> Filter_1.index:</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>    nyc311.loc[index,<span class="st">'Latitude'</span>]   <span class="op">=</span> Filter_1[<span class="st">'Latitude'</span>][index]</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>    nyc311.loc[index,<span class="st">'Longitude'</span>] <span class="op">=</span> Filter_1[<span class="st">'Longitude'</span>][index]</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the remaining data that has missing Latitude and Longitude</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>Filter_1 <span class="op">=</span> nyc311[nyc311[<span class="st">'Latitude'</span>].isnull()]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>These are the remaining latitude and longitude that is missing</p>
<div class="cell" data-execution_count="13">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>Filter_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="37">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Unique Key</th>
      <th>Created Date</th>
      <th>Closed Date</th>
      <th>Agency</th>
      <th>Agency Name</th>
      <th>Complaint Type</th>
      <th>Descriptor</th>
      <th>Location Type</th>
      <th>Incident Zip</th>
      <th>Incident Address</th>
      <th>...</th>
      <th>Taxi Company Borough</th>
      <th>Taxi Pick Up Location</th>
      <th>Bridge Highway Name</th>
      <th>Bridge Highway Direction</th>
      <th>Road Ramp</th>
      <th>Bridge Highway Segment</th>
      <th>Latitude</th>
      <th>Longitude</th>
      <th>Location</th>
      <th>Loingitude</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1067</th>
      <td>56533187</td>
      <td>2023-01-15 05:39:14</td>
      <td>2023-01-17 13:14:50</td>
      <td>DOT</td>
      <td>Department of Transportation</td>
      <td>Ferry Complaint</td>
      <td>Delays</td>
      <td>Ferry</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1873</th>
      <td>56531825</td>
      <td>2023-01-15 09:31:42</td>
      <td>NaT</td>
      <td>TLC</td>
      <td>Taxi and Limousine Commission</td>
      <td>Taxi Complaint</td>
      <td>Driver Complaint - Non Passenger</td>
      <td>Street</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3207</th>
      <td>56537996</td>
      <td>2023-01-15 12:57:30</td>
      <td>NaT</td>
      <td>TLC</td>
      <td>Taxi and Limousine Commission</td>
      <td>For Hire Vehicle Complaint</td>
      <td>Driver Complaint - Non Passenger</td>
      <td>Street</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4128</th>
      <td>56537038</td>
      <td>2023-01-15 15:32:05</td>
      <td>2023-01-18 09:24:29</td>
      <td>TLC</td>
      <td>Taxi and Limousine Commission</td>
      <td>Lost Property</td>
      <td>Bag/Wallet</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>1000 10th Ave, New York, NY 10019, USA</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4364</th>
      <td>56535371</td>
      <td>2023-01-15 16:12:00</td>
      <td>2023-01-18 07:00:41</td>
      <td>DOT</td>
      <td>Department of Transportation</td>
      <td>Highway Condition</td>
      <td>Pothole - Highway</td>
      <td>Highway</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Belt Pkwy</td>
      <td>East/Queens Bound</td>
      <td>Roadway</td>
      <td>Coney Island Ave (Exit 8) - Knapp St Sheepshea...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>50169</th>
      <td>56587808</td>
      <td>2023-01-21 11:31:51</td>
      <td>2023-01-24 08:32:50</td>
      <td>DOT</td>
      <td>Department of Transportation</td>
      <td>Highway Condition</td>
      <td>Pothole - Highway</td>
      <td>Highway</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Long Island Expwy</td>
      <td>West/Manhattan Bound</td>
      <td>Roadway</td>
      <td>Junction Blvd (Exit 20) - Queens Blvd (NY 25) ...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>52200</th>
      <td>56587713</td>
      <td>2023-01-21 17:12:08</td>
      <td>NaT</td>
      <td>TLC</td>
      <td>Taxi and Limousine Commission</td>
      <td>For Hire Vehicle Complaint</td>
      <td>Driver Complaint - Non Passenger</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>Northern Blvd, New York, ç¾å</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>52561</th>
      <td>56587575</td>
      <td>2023-01-21 18:19:49</td>
      <td>NaT</td>
      <td>DOT</td>
      <td>Department of Transportation</td>
      <td>Highway Condition</td>
      <td>Graffiti - Highway</td>
      <td>Highway</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Jackie Robinson/Interboro Pkwy</td>
      <td>West/Brooklyn Bound</td>
      <td>Roadway</td>
      <td>Forest Park Dr (Exit 4) - Cypress Hills St (Ex...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>53940</th>
      <td>56589030</td>
      <td>2023-01-21 22:47:03</td>
      <td>2023-01-22 00:04:27</td>
      <td>NYPD</td>
      <td>New York City Police Department</td>
      <td>Traffic</td>
      <td>Drag Racing</td>
      <td>Highway</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Belt Pkwy</td>
      <td>West/Staten Island Bound</td>
      <td>Roadway</td>
      <td>Cross Bay Blvd (Exit 17S) - Erskine St (Exit 15)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>53985</th>
      <td>56587843</td>
      <td>2023-01-21 22:55:35</td>
      <td>2023-01-24 08:32:23</td>
      <td>DOT</td>
      <td>Department of Transportation</td>
      <td>Highway Condition</td>
      <td>Pothole - Highway</td>
      <td>Highway</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Long Island Expwy</td>
      <td>West/Manhattan Bound</td>
      <td>Roadway</td>
      <td>Junction Blvd (Exit 20) - Queens Blvd (NY 25) ...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>180 rows × 42 columns</p>
</div>
</div>
</div>
<p>Most of the latitude are due to most location is at hightway.</p>
<p>Now work on getting zipcode from available <code>latitude</code> and <code>longitude</code>.</p>
<div class="cell" data-execution_count="14">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>Filter_1 <span class="op">=</span> nyc311[nyc311[<span class="st">'Incident Zip'</span>].isnull()]</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>Filter_1 <span class="op">=</span> Filter_1[Filter_1[<span class="st">'Latitude'</span>].notnull()]</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> index <span class="kw">in</span> Filter_1.index:</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    z <span class="op">=</span> search.by_coordinates(Filter_1[<span class="st">'Latitude'</span>][index],Filter_1[<span class="st">'Longitude'</span>][index], radius <span class="op">=</span> <span class="dv">25</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    Filter_1.loc[index,<span class="st">'Incident Zip'</span>] <span class="op">=</span> z[<span class="dv">0</span>].zipcode</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Make an update</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> index <span class="kw">in</span> Filter_1.index:</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    nyc311.loc[index,<span class="st">'Incident Zip'</span>]   <span class="op">=</span> Filter_1[<span class="st">'Incident Zip'</span>][index]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The remaining missing date still shown here, this means that the rest of the <code>Incident Zip</code> is filled!</p>
<div class="cell" data-execution_count="15">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>Filter_1 <span class="op">=</span> nyc311[nyc311[<span class="st">'Incident Zip'</span>].isnull()]</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>Filter_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="39">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Unique Key</th>
      <th>Created Date</th>
      <th>Closed Date</th>
      <th>Agency</th>
      <th>Agency Name</th>
      <th>Complaint Type</th>
      <th>Descriptor</th>
      <th>Location Type</th>
      <th>Incident Zip</th>
      <th>Incident Address</th>
      <th>...</th>
      <th>Taxi Company Borough</th>
      <th>Taxi Pick Up Location</th>
      <th>Bridge Highway Name</th>
      <th>Bridge Highway Direction</th>
      <th>Road Ramp</th>
      <th>Bridge Highway Segment</th>
      <th>Latitude</th>
      <th>Longitude</th>
      <th>Location</th>
      <th>Loingitude</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1067</th>
      <td>56533187</td>
      <td>2023-01-15 05:39:14</td>
      <td>2023-01-17 13:14:50</td>
      <td>DOT</td>
      <td>Department of Transportation</td>
      <td>Ferry Complaint</td>
      <td>Delays</td>
      <td>Ferry</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1873</th>
      <td>56531825</td>
      <td>2023-01-15 09:31:42</td>
      <td>NaT</td>
      <td>TLC</td>
      <td>Taxi and Limousine Commission</td>
      <td>Taxi Complaint</td>
      <td>Driver Complaint - Non Passenger</td>
      <td>Street</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3207</th>
      <td>56537996</td>
      <td>2023-01-15 12:57:30</td>
      <td>NaT</td>
      <td>TLC</td>
      <td>Taxi and Limousine Commission</td>
      <td>For Hire Vehicle Complaint</td>
      <td>Driver Complaint - Non Passenger</td>
      <td>Street</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4128</th>
      <td>56537038</td>
      <td>2023-01-15 15:32:05</td>
      <td>2023-01-18 09:24:29</td>
      <td>TLC</td>
      <td>Taxi and Limousine Commission</td>
      <td>Lost Property</td>
      <td>Bag/Wallet</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>1000 10th Ave, New York, NY 10019, USA</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4364</th>
      <td>56535371</td>
      <td>2023-01-15 16:12:00</td>
      <td>2023-01-18 07:00:41</td>
      <td>DOT</td>
      <td>Department of Transportation</td>
      <td>Highway Condition</td>
      <td>Pothole - Highway</td>
      <td>Highway</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Belt Pkwy</td>
      <td>East/Queens Bound</td>
      <td>Roadway</td>
      <td>Coney Island Ave (Exit 8) - Knapp St Sheepshea...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>50169</th>
      <td>56587808</td>
      <td>2023-01-21 11:31:51</td>
      <td>2023-01-24 08:32:50</td>
      <td>DOT</td>
      <td>Department of Transportation</td>
      <td>Highway Condition</td>
      <td>Pothole - Highway</td>
      <td>Highway</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Long Island Expwy</td>
      <td>West/Manhattan Bound</td>
      <td>Roadway</td>
      <td>Junction Blvd (Exit 20) - Queens Blvd (NY 25) ...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>52200</th>
      <td>56587713</td>
      <td>2023-01-21 17:12:08</td>
      <td>NaT</td>
      <td>TLC</td>
      <td>Taxi and Limousine Commission</td>
      <td>For Hire Vehicle Complaint</td>
      <td>Driver Complaint - Non Passenger</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>Northern Blvd, New York, ç¾å</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>52561</th>
      <td>56587575</td>
      <td>2023-01-21 18:19:49</td>
      <td>NaT</td>
      <td>DOT</td>
      <td>Department of Transportation</td>
      <td>Highway Condition</td>
      <td>Graffiti - Highway</td>
      <td>Highway</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Jackie Robinson/Interboro Pkwy</td>
      <td>West/Brooklyn Bound</td>
      <td>Roadway</td>
      <td>Forest Park Dr (Exit 4) - Cypress Hills St (Ex...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>53940</th>
      <td>56589030</td>
      <td>2023-01-21 22:47:03</td>
      <td>2023-01-22 00:04:27</td>
      <td>NYPD</td>
      <td>New York City Police Department</td>
      <td>Traffic</td>
      <td>Drag Racing</td>
      <td>Highway</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Belt Pkwy</td>
      <td>West/Staten Island Bound</td>
      <td>Roadway</td>
      <td>Cross Bay Blvd (Exit 17S) - Erskine St (Exit 15)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>53985</th>
      <td>56587843</td>
      <td>2023-01-21 22:55:35</td>
      <td>2023-01-24 08:32:23</td>
      <td>DOT</td>
      <td>Department of Transportation</td>
      <td>Highway Condition</td>
      <td>Pothole - Highway</td>
      <td>Highway</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Long Island Expwy</td>
      <td>West/Manhattan Bound</td>
      <td>Roadway</td>
      <td>Junction Blvd (Exit 20) - Queens Blvd (NY 25) ...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>180 rows × 42 columns</p>
</div>
</div>
</div>
<p>Update <code>Borough</code> from <code>Incident Zip</code>.</p>
<div class="cell" data-execution_count="16">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function that classified the borough</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> nyczip2burough(<span class="bu">zip</span>):</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    nzip <span class="op">=</span> <span class="bu">int</span>(<span class="bu">zip</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> nzip <span class="op">&gt;=</span> <span class="dv">10001</span> <span class="kw">and</span> nzip <span class="op">&lt;=</span> <span class="dv">10282</span>:</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">"MANHATTAN"</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> nzip <span class="op">&gt;=</span> <span class="dv">10301</span> <span class="kw">and</span> nzip <span class="op">&lt;=</span> <span class="dv">10314</span>:</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">"STATEN ISLAND"</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> nzip <span class="op">&gt;=</span> <span class="dv">10451</span> <span class="kw">and</span> nzip <span class="op">&lt;=</span> <span class="dv">10475</span>:</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">"BRONX"</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> nzip <span class="op">&gt;=</span> <span class="dv">11004</span> <span class="kw">and</span> nzip <span class="op">&lt;=</span> <span class="dv">11109</span>:</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">"QUEENS"</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> nzip <span class="op">&gt;=</span> <span class="dv">11351</span> <span class="kw">and</span> nzip <span class="op">&lt;=</span> <span class="dv">11697</span>:</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">"QUEENS"</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> nzip <span class="op">&gt;=</span> <span class="dv">11201</span> <span class="kw">and</span> nzip <span class="op">&lt;=</span> <span class="dv">11256</span>:</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">"BROOKLYN"</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> np.nan</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>Filter_1 <span class="op">=</span> nyc311[nyc311[<span class="st">'Borough'</span>] <span class="op">==</span> <span class="st">'Unspecified'</span>]</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>Filter_1 <span class="op">=</span> Filter_1[Filter_1[<span class="st">'Incident Zip'</span>].notnull()]</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> index <span class="kw">in</span> Filter_1.index:</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>    burough <span class="op">=</span> nyczip2burough(Filter_1.loc[index,[<span class="st">'Incident Zip'</span>]])</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>    Filter_1.loc[index,<span class="st">'Borough'</span>] <span class="op">=</span> burough</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a><span class="co">#Update the data</span></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> index <span class="kw">in</span> Filter_1.index:</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>  nyc311.loc[index,<span class="st">'Borough'</span>]   <span class="op">=</span> Filter_1[<span class="st">'Borough'</span>][index]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Get <code>X Coordinate (State Plane)</code>and <code>Y Coordinate (State Plane)</code> using <code>stateplane</code>.</p>
<div class="cell" data-execution_count="17">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> stateplane</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>Filter_1 <span class="op">=</span> nyc311[nyc311[<span class="st">'X Coordinate (State Plane)'</span>].isnull()]</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>Filter_1 <span class="op">=</span> Filter_1[Filter_1[<span class="st">'Latitude'</span>].notnull()]</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> index <span class="kw">in</span> Filter_1.index:</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    x, y <span class="op">=</span> stateplane.from_lonlat(Filter_1[<span class="st">'Longitude'</span>][index],Filter_1[<span class="st">'Latitude'</span>][index])</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    Filter_1.loc[index,<span class="st">'X Coordinate (State Plane)'</span>] <span class="op">=</span> x</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    Filter_1.loc[index,<span class="st">'Y Coordinate (State Plane)'</span>] <span class="op">=</span> y</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> index <span class="kw">in</span> Filter_1.index:</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>    nyc311.loc[index,<span class="st">'X Coordinate (State Plane)'</span>] <span class="op">=</span> Filter_1[<span class="st">'X Coordinate (State Plane)'</span>][index]</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>    nyc311.loc[index,<span class="st">'Y Coordinate (State Plane)'</span>] <span class="op">=</span> Filter_1[<span class="st">'Y Coordinate (State Plane)'</span>][index]</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a><span class="co">#Show the filled state plane </span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>Filter_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>C:\Users\YkChua\.conda\envs\ML_DataScience\lib\site-packages\shapely\predicates.py:540: RuntimeWarning: invalid value encountered in contains
C:\Users\YkChua\.conda\envs\ML_DataScience\lib\site-packages\shapely\measurement.py:74: RuntimeWarning: invalid value encountered in distance</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="41">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Unique Key</th>
      <th>Created Date</th>
      <th>Closed Date</th>
      <th>Agency</th>
      <th>Agency Name</th>
      <th>Complaint Type</th>
      <th>Descriptor</th>
      <th>Location Type</th>
      <th>Incident Zip</th>
      <th>Incident Address</th>
      <th>...</th>
      <th>Taxi Company Borough</th>
      <th>Taxi Pick Up Location</th>
      <th>Bridge Highway Name</th>
      <th>Bridge Highway Direction</th>
      <th>Road Ramp</th>
      <th>Bridge Highway Segment</th>
      <th>Latitude</th>
      <th>Longitude</th>
      <th>Location</th>
      <th>Loingitude</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>539</th>
      <td>56530078</td>
      <td>2023-01-15 01:50:16</td>
      <td>2023-01-15 02:53:59</td>
      <td>NYPD</td>
      <td>New York City Police Department</td>
      <td>Noise - Vehicle</td>
      <td>Car/Truck Music</td>
      <td>Street/Sidewalk</td>
      <td>10468.0</td>
      <td>CRESTON AVENUE</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>40.870000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-73.90</td>
    </tr>
    <tr>
      <th>1197</th>
      <td>56537742</td>
      <td>2023-01-15 06:57:00</td>
      <td>2023-01-15 09:10:00</td>
      <td>DOT</td>
      <td>Department of Transportation</td>
      <td>Traffic Signal Condition</td>
      <td>Controller</td>
      <td>NaN</td>
      <td>11429</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>40.711285</td>
      <td>-73.728634</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1260</th>
      <td>56532819</td>
      <td>2023-01-15 07:21:21</td>
      <td>2023-01-15 07:21:21</td>
      <td>DOT</td>
      <td>Department of Transportation</td>
      <td>Street Condition</td>
      <td>Pothole</td>
      <td>NaN</td>
      <td>10026.0</td>
      <td>WEST  110 STREET</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>40.800000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-73.95</td>
    </tr>
    <tr>
      <th>1261</th>
      <td>56535357</td>
      <td>2023-01-15 07:21:21</td>
      <td>2023-01-15 07:21:21</td>
      <td>DOT</td>
      <td>Department of Transportation</td>
      <td>Street Condition</td>
      <td>Pothole</td>
      <td>NaN</td>
      <td>10026.0</td>
      <td>WEST  110 STREET</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>40.800000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-73.95</td>
    </tr>
    <tr>
      <th>1262</th>
      <td>56537491</td>
      <td>2023-01-15 07:21:21</td>
      <td>2023-01-17 12:35:00</td>
      <td>DOT</td>
      <td>Department of Transportation</td>
      <td>Street Condition</td>
      <td>Pothole</td>
      <td>NaN</td>
      <td>10026.0</td>
      <td>WEST  110 STREET</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>40.800000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-73.95</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>53691</th>
      <td>56588548</td>
      <td>2023-01-21 22:09:24</td>
      <td>2023-01-21 22:09:24</td>
      <td>DOT</td>
      <td>Department of Transportation</td>
      <td>Street Condition</td>
      <td>Pothole</td>
      <td>NaN</td>
      <td>10310.0</td>
      <td>HARVEST AVENUE</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>40.630000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-74.12</td>
    </tr>
    <tr>
      <th>53699</th>
      <td>56585027</td>
      <td>2023-01-21 22:10:54</td>
      <td>2023-01-21 22:55:15</td>
      <td>NYPD</td>
      <td>New York City Police Department</td>
      <td>Illegal Parking</td>
      <td>Posted Parking Sign Violation</td>
      <td>Street/Sidewalk</td>
      <td>10019.0</td>
      <td>WEST   56 STREET</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>40.770000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-73.99</td>
    </tr>
    <tr>
      <th>53819</th>
      <td>56585350</td>
      <td>2023-01-21 22:31:45</td>
      <td>2023-01-23 11:05:00</td>
      <td>DOT</td>
      <td>Department of Transportation</td>
      <td>Street Condition</td>
      <td>Pothole</td>
      <td>NaN</td>
      <td>11422.0</td>
      <td>143 AVENUE</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>40.660000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-73.73</td>
    </tr>
    <tr>
      <th>53933</th>
      <td>56585351</td>
      <td>2023-01-21 22:46:04</td>
      <td>2023-01-23 08:54:00</td>
      <td>DOT</td>
      <td>Department of Transportation</td>
      <td>Street Condition</td>
      <td>Pothole</td>
      <td>NaN</td>
      <td>11374.0</td>
      <td>YELLOWSTONE BOULEVARD</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>40.720000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-73.86</td>
    </tr>
    <tr>
      <th>53964</th>
      <td>56588862</td>
      <td>2023-01-21 22:51:53</td>
      <td>2023-01-23 09:25:00</td>
      <td>DOT</td>
      <td>Department of Transportation</td>
      <td>Street Condition</td>
      <td>Pothole</td>
      <td>NaN</td>
      <td>11691.0</td>
      <td>CAFFREY AVENUE</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>40.600000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-73.76</td>
    </tr>
  </tbody>
</table>
<p>797 rows × 42 columns</p>
</div>
</div>
</div>
<p>Remove the request not from NYPD</p>
<div class="cell" data-execution_count="18">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>nyc311_NYPD <span class="op">=</span> nyc311[nyc311[<span class="st">'Agency'</span>] <span class="op">==</span> <span class="st">'NYPD'</span>]</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> nyc311_NYPD[nyc311_NYPD[<span class="st">'Closed Date'</span>].isnull()]</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>A</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="42">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Unique Key</th>
      <th>Created Date</th>
      <th>Closed Date</th>
      <th>Agency</th>
      <th>Agency Name</th>
      <th>Complaint Type</th>
      <th>Descriptor</th>
      <th>Location Type</th>
      <th>Incident Zip</th>
      <th>Incident Address</th>
      <th>...</th>
      <th>Taxi Company Borough</th>
      <th>Taxi Pick Up Location</th>
      <th>Bridge Highway Name</th>
      <th>Bridge Highway Direction</th>
      <th>Road Ramp</th>
      <th>Bridge Highway Segment</th>
      <th>Latitude</th>
      <th>Longitude</th>
      <th>Location</th>
      <th>Loingitude</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2407</th>
      <td>56532919</td>
      <td>2023-01-15 11:05:17</td>
      <td>NaT</td>
      <td>NYPD</td>
      <td>New York City Police Department</td>
      <td>Blocked Driveway</td>
      <td>No Access</td>
      <td>Street/Sidewalk</td>
      <td>11212.0</td>
      <td>494 EAST   95 STREET</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>40.655622</td>
      <td>-73.916891</td>
      <td>(40.65562177191011, -73.91689052688147)</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>1 rows × 42 columns</p>
</div>
</div>
</div>
<p>Only one data still in progress. We can remove that too.</p>
<div class="cell" data-execution_count="19">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>nyc311_NYPD <span class="op">=</span> nyc311_NYPD[nyc311_NYPD[<span class="st">'Closed Date'</span>].notnull()]</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>nyc311_NYPD[<span class="st">'duration'</span>] <span class="op">=</span> nyc311_NYPD[<span class="st">'Closed Date'</span>] <span class="op">-</span> nyc311_NYPD[<span class="st">'Created Date'</span>]</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>col <span class="op">=</span> nyc311_NYPD.pop(<span class="st">"duration"</span>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>s_hours <span class="op">=</span> col.dt.total_seconds() <span class="op">/</span> <span class="fl">3600.0</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>nyc311_NYPD.insert(<span class="dv">3</span>,s_hours.name ,s_hours)</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>nyc311_NYPD[<span class="st">'day_type'</span>] <span class="op">=</span> nyc311_NYPD[<span class="st">'Created Date'</span>].dt.dayofweek</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> index <span class="kw">in</span> nyc311_NYPD.index:</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> nyc311_NYPD[<span class="st">'day_type'</span>][index] <span class="op">&lt;</span> <span class="dv">5</span>:</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>       nyc311_NYPD.loc[index,<span class="st">'day_type'</span>] <span class="op">=</span> <span class="st">'Weekday'</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>       nyc311_NYPD.loc[index,<span class="st">'day_type'</span>] <span class="op">=</span> <span class="st">'Weekend'</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>col <span class="op">=</span> nyc311_NYPD.pop(<span class="st">"day_type"</span>)</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>nyc311_NYPD.insert(<span class="dv">4</span>,col.name ,col)</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>nyc311_NYPD</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="43">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Unique Key</th>
      <th>Created Date</th>
      <th>Closed Date</th>
      <th>duration</th>
      <th>day_type</th>
      <th>Agency</th>
      <th>Agency Name</th>
      <th>Complaint Type</th>
      <th>Descriptor</th>
      <th>Location Type</th>
      <th>...</th>
      <th>Taxi Company Borough</th>
      <th>Taxi Pick Up Location</th>
      <th>Bridge Highway Name</th>
      <th>Bridge Highway Direction</th>
      <th>Road Ramp</th>
      <th>Bridge Highway Segment</th>
      <th>Latitude</th>
      <th>Longitude</th>
      <th>Location</th>
      <th>Loingitude</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5</th>
      <td>56524984</td>
      <td>2023-01-15 00:00:18</td>
      <td>2023-01-15 02:37:30</td>
      <td>2.620000</td>
      <td>Weekend</td>
      <td>NYPD</td>
      <td>New York City Police Department</td>
      <td>Noise - Residential</td>
      <td>Banging/Pounding</td>
      <td>Residential Building/House</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>40.863611</td>
      <td>-73.870409</td>
      <td>(40.8636112787934, -73.87040864262848)</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>56526790</td>
      <td>2023-01-15 00:00:21</td>
      <td>2023-01-15 01:54:24</td>
      <td>1.900833</td>
      <td>Weekend</td>
      <td>NYPD</td>
      <td>New York City Police Department</td>
      <td>Noise - Street/Sidewalk</td>
      <td>Loud Music/Party</td>
      <td>Street/Sidewalk</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>40.702772</td>
      <td>-73.837580</td>
      <td>(40.70277200816068, -73.83758019372564)</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7</th>
      <td>56525034</td>
      <td>2023-01-15 00:00:50</td>
      <td>2023-01-15 01:09:56</td>
      <td>1.151667</td>
      <td>Weekend</td>
      <td>NYPD</td>
      <td>New York City Police Department</td>
      <td>Illegal Parking</td>
      <td>Posted Parking Sign Violation</td>
      <td>Street/Sidewalk</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>40.687196</td>
      <td>-73.981921</td>
      <td>(40.68719608843765, -73.98192072171082)</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>8</th>
      <td>56526234</td>
      <td>2023-01-15 00:01:02</td>
      <td>2023-01-15 05:47:41</td>
      <td>5.777500</td>
      <td>Weekend</td>
      <td>NYPD</td>
      <td>New York City Police Department</td>
      <td>Noise - Residential</td>
      <td>Loud Music/Party</td>
      <td>Residential Building/House</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>40.832358</td>
      <td>-73.858906</td>
      <td>(40.83235751279932, -73.85890589915455)</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>9</th>
      <td>56530817</td>
      <td>2023-01-15 00:01:07</td>
      <td>2023-01-15 01:01:26</td>
      <td>1.005278</td>
      <td>Weekend</td>
      <td>NYPD</td>
      <td>New York City Police Department</td>
      <td>Noise - Residential</td>
      <td>Banging/Pounding</td>
      <td>Residential Building/House</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>40.773667</td>
      <td>-73.947833</td>
      <td>(40.773667438961155, -73.94783272698673)</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>54459</th>
      <td>56585700</td>
      <td>2023-01-21 23:58:48</td>
      <td>2023-01-22 01:30:36</td>
      <td>1.530000</td>
      <td>Weekend</td>
      <td>NYPD</td>
      <td>New York City Police Department</td>
      <td>Noise - Commercial</td>
      <td>Loud Music/Party</td>
      <td>Club/Bar/Restaurant</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>40.706779</td>
      <td>-73.929213</td>
      <td>(40.70677887148764, -73.92921256734658)</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>54461</th>
      <td>56588661</td>
      <td>2023-01-21 23:59:10</td>
      <td>2023-01-22 02:50:54</td>
      <td>2.862222</td>
      <td>Weekend</td>
      <td>NYPD</td>
      <td>New York City Police Department</td>
      <td>Noise - Residential</td>
      <td>Loud Music/Party</td>
      <td>Residential Building/House</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>40.722513</td>
      <td>-73.946805</td>
      <td>(40.72251308480256, -73.94680489829233)</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>54462</th>
      <td>56591186</td>
      <td>2023-01-21 23:59:12</td>
      <td>2023-01-22 06:41:47</td>
      <td>6.709722</td>
      <td>Weekend</td>
      <td>NYPD</td>
      <td>New York City Police Department</td>
      <td>Illegal Parking</td>
      <td>Posted Parking Sign Violation</td>
      <td>Street/Sidewalk</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>40.694502</td>
      <td>-73.977995</td>
      <td>(40.694501981434954, -73.97799524430377)</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>54463</th>
      <td>56587053</td>
      <td>2023-01-21 23:59:24</td>
      <td>2023-01-22 06:24:40</td>
      <td>6.421111</td>
      <td>Weekend</td>
      <td>NYPD</td>
      <td>New York City Police Department</td>
      <td>Noise - Residential</td>
      <td>Loud Music/Party</td>
      <td>Residential Building/House</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>40.757643</td>
      <td>-73.875333</td>
      <td>(40.75764288488996, -73.87533252677208)</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>54464</th>
      <td>56590382</td>
      <td>2023-01-22 00:00:00</td>
      <td>2023-01-22 04:29:17</td>
      <td>4.488056</td>
      <td>Weekend</td>
      <td>NYPD</td>
      <td>New York City Police Department</td>
      <td>Noise - Residential</td>
      <td>Loud Music/Party</td>
      <td>Residential Building/House</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>40.846388</td>
      <td>-73.828280</td>
      <td>(40.84638812959795, -73.82828029128923)</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>21534 rows × 44 columns</p>
</div>
</div>
</div>
<p>Visualize the distribution of uncensored duration by weekdays/weekend and by borough</p>
<div class="cell" data-execution_count="20">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove the unspecified Borough</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>nyc311_NYPD <span class="op">=</span> nyc311_NYPD[ nyc311_NYPD[<span class="st">'Borough'</span>] <span class="op">!=</span> <span class="st">'Unspecified'</span>]</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove the zipcode that is null due to missing latitude and longitude</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>nyc311_NYPD <span class="op">=</span> nyc311_NYPD[nyc311_NYPD[<span class="st">'Incident Zip'</span>].notnull()]</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> plotnine <span class="im">import</span> <span class="op">*</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    ggplot(nyc311_NYPD, aes(x<span class="op">=</span><span class="st">'day_type'</span>,fill<span class="op">=</span><span class="st">'Borough'</span>))</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> geom_histogram(binwidth<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Midterm_Project_files/figure-html/cell-21-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display" data-execution_count="44">
<pre><code>&lt;ggplot: (156453274122)&gt;</code></pre>
</div>
</div>
<p>Test whether the distributions are the same across weekdays/weekends and across borough.</p>
<div class="cell" data-execution_count="21">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a crosstab</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>Cross <span class="op">=</span> pd.crosstab(index<span class="op">=</span>nyc311_NYPD[<span class="st">'day_type'</span>], columns<span class="op">=</span>nyc311_NYPD[<span class="st">'Borough'</span>])</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>Cross</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="45">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th>Borough</th>
      <th>BRONX</th>
      <th>BROOKLYN</th>
      <th>MANHATTAN</th>
      <th>QUEENS</th>
      <th>STATEN ISLAND</th>
    </tr>
    <tr>
      <th>day_type</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Weekday</th>
      <td>2694</td>
      <td>5204</td>
      <td>2689</td>
      <td>4041</td>
      <td>433</td>
    </tr>
    <tr>
      <th>Weekend</th>
      <td>1254</td>
      <td>2062</td>
      <td>1151</td>
      <td>1819</td>
      <td>141</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Null hypothesis is there is no assocition between <code>day_type</code> and <code>Borough</code>.</p>
<div class="cell" data-execution_count="22">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> chi2_contingency</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the crosstab to array</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>Cross <span class="op">=</span> Cross.to_numpy()</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>chi2, pval, dof, expected <span class="op">=</span> chi2_contingency(Cross)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Chi-square statistic:"</span>, chi2)</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Degrees of freedom:"</span>, dof)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"P-value:"</span>, pval)</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Expected frequencies:</span><span class="ch">\n</span><span class="st">"</span>, expected)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Chi-square statistic: 25.99928713782284
Degrees of freedom: 4
P-value: 3.165508689260228e-05
Expected frequencies:
 [[2767.16437081 5092.75995905 2691.46686523 4107.29058079  402.31822413]
 [1180.83562919 2173.24004095 1148.53313477 1752.70941921  171.68177587]]</code></pre>
</div>
</div>
<p>A p-value of 3.165508689260228e-05 indicates that there is strong evidence to suggest that there is an association between day_type and Borough.</p>
<p>Lets merge with uszipcode data.</p>
<div class="cell" data-execution_count="23">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="co"># set the default database file location</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>db_file <span class="op">=</span> os.path.abspath(<span class="st">"simple_db.sqlite"</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sqlite3</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co"># change to your own path after installing uszipcode</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>con <span class="op">=</span> sqlite3.<span class="ex">connect</span>(db_file)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>zipdf <span class="op">=</span> pd.read_sql_query(<span class="st">"SELECT * from simple_zipcode"</span>, con)</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>zipdf.info()</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Change the type to float64</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>zipdf[<span class="st">'zipcode'</span>] <span class="op">=</span> zipdf[<span class="st">'zipcode'</span>].astype(<span class="st">'float64'</span>)</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Change the type to float64 too</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>nyc311_NYPD[<span class="st">'Incident Zip'</span>] <span class="op">=</span> nyc311_NYPD[<span class="st">'Incident Zip'</span>].astype(<span class="st">'float64'</span>)</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>merged_df <span class="op">=</span> pd.merge(nyc311_NYPD, zipdf, how <span class="op">=</span> <span class="st">'left'</span>, left_on <span class="op">=</span> <span class="st">'Incident Zip'</span>, right_on <span class="op">=</span> <span class="st">'zipcode'</span>)</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop repeating data</span></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>merged_df <span class="op">=</span> merged_df.drop([<span class="st">'zipcode'</span>,<span class="st">'lat'</span>,<span class="st">'lng'</span>],axis <span class="op">=</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 42724 entries, 0 to 42723
Data columns (total 24 columns):
 #   Column                   Non-Null Count  Dtype  
---  ------                   --------------  -----  
 0   zipcode                  42724 non-null  object 
 1   zipcode_type             42724 non-null  object 
 2   major_city               42724 non-null  object 
 3   post_office_city         33104 non-null  object 
 4   common_city_list         41877 non-null  object 
 5   county                   42724 non-null  object 
 6   state                    42724 non-null  object 
 7   lat                      42724 non-null  float64
 8   lng                      42724 non-null  float64
 9   timezone                 42724 non-null  object 
 10  radius_in_miles          33104 non-null  float64
 11  area_code_list           42724 non-null  object 
 12  population               31448 non-null  float64
 13  population_density       31448 non-null  float64
 14  land_area_in_sqmi        31448 non-null  float64
 15  water_area_in_sqmi       31448 non-null  float64
 16  housing_units            31448 non-null  float64
 17  occupied_housing_units   31448 non-null  float64
 18  median_home_value        31448 non-null  float64
 19  median_household_income  31448 non-null  float64
 20  bounds_west              33104 non-null  float64
 21  bounds_east              33104 non-null  float64
 22  bounds_north             33104 non-null  float64
 23  bounds_south             33104 non-null  float64
dtypes: float64(15), object(9)
memory usage: 7.8+ MB</code></pre>
</div>
</div>
<p>Displaying merged data.</p>
<div class="cell" data-execution_count="24">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>merged_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="48">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Unique Key</th>
      <th>Created Date</th>
      <th>Closed Date</th>
      <th>duration</th>
      <th>day_type</th>
      <th>Agency</th>
      <th>Agency Name</th>
      <th>Complaint Type</th>
      <th>Descriptor</th>
      <th>Location Type</th>
      <th>...</th>
      <th>land_area_in_sqmi</th>
      <th>water_area_in_sqmi</th>
      <th>housing_units</th>
      <th>occupied_housing_units</th>
      <th>median_home_value</th>
      <th>median_household_income</th>
      <th>bounds_west</th>
      <th>bounds_east</th>
      <th>bounds_north</th>
      <th>bounds_south</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>56524984</td>
      <td>2023-01-15 00:00:18</td>
      <td>2023-01-15 02:37:30</td>
      <td>2.620000</td>
      <td>Weekend</td>
      <td>NYPD</td>
      <td>New York City Police Department</td>
      <td>Noise - Residential</td>
      <td>Banging/Pounding</td>
      <td>Residential Building/House</td>
      <td>...</td>
      <td>2.33</td>
      <td>0.00</td>
      <td>37432.0</td>
      <td>35524.0</td>
      <td>369500.0</td>
      <td>36048.0</td>
      <td>-73.895710</td>
      <td>-73.855691</td>
      <td>40.908016</td>
      <td>40.857266</td>
    </tr>
    <tr>
      <th>1</th>
      <td>56526790</td>
      <td>2023-01-15 00:00:21</td>
      <td>2023-01-15 01:54:24</td>
      <td>1.900833</td>
      <td>Weekend</td>
      <td>NYPD</td>
      <td>New York City Police Department</td>
      <td>Noise - Street/Sidewalk</td>
      <td>Loud Music/Party</td>
      <td>Street/Sidewalk</td>
      <td>...</td>
      <td>1.63</td>
      <td>0.00</td>
      <td>11854.0</td>
      <td>11031.0</td>
      <td>427000.0</td>
      <td>60691.0</td>
      <td>-73.854747</td>
      <td>-73.813659</td>
      <td>40.711641</td>
      <td>40.689442</td>
    </tr>
    <tr>
      <th>2</th>
      <td>56525034</td>
      <td>2023-01-15 00:00:50</td>
      <td>2023-01-15 01:09:56</td>
      <td>1.151667</td>
      <td>Weekend</td>
      <td>NYPD</td>
      <td>New York City Police Department</td>
      <td>Illegal Parking</td>
      <td>Posted Parking Sign Violation</td>
      <td>Street/Sidewalk</td>
      <td>...</td>
      <td>0.75</td>
      <td>0.00</td>
      <td>17581.0</td>
      <td>16269.0</td>
      <td>857000.0</td>
      <td>81862.0</td>
      <td>-73.990867</td>
      <td>-73.970640</td>
      <td>40.689901</td>
      <td>40.672639</td>
    </tr>
    <tr>
      <th>3</th>
      <td>56526234</td>
      <td>2023-01-15 00:01:02</td>
      <td>2023-01-15 05:47:41</td>
      <td>5.777500</td>
      <td>Weekend</td>
      <td>NYPD</td>
      <td>New York City Police Department</td>
      <td>Noise - Residential</td>
      <td>Loud Music/Party</td>
      <td>Residential Building/House</td>
      <td>...</td>
      <td>1.05</td>
      <td>0.00</td>
      <td>23386.0</td>
      <td>22002.0</td>
      <td>429600.0</td>
      <td>30288.0</td>
      <td>-73.884568</td>
      <td>-73.845633</td>
      <td>40.836137</td>
      <td>40.823160</td>
    </tr>
    <tr>
      <th>4</th>
      <td>56530817</td>
      <td>2023-01-15 00:01:07</td>
      <td>2023-01-15 01:01:26</td>
      <td>1.005278</td>
      <td>Weekend</td>
      <td>NYPD</td>
      <td>New York City Police Department</td>
      <td>Noise - Residential</td>
      <td>Banging/Pounding</td>
      <td>Residential Building/House</td>
      <td>...</td>
      <td>0.31</td>
      <td>0.00</td>
      <td>28139.0</td>
      <td>25158.0</td>
      <td>1000001.0</td>
      <td>104638.0</td>
      <td>-73.963230</td>
      <td>-73.944337</td>
      <td>40.782213</td>
      <td>40.770062</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>21483</th>
      <td>56585700</td>
      <td>2023-01-21 23:58:48</td>
      <td>2023-01-22 01:30:36</td>
      <td>1.530000</td>
      <td>Weekend</td>
      <td>NYPD</td>
      <td>New York City Police Department</td>
      <td>Noise - Commercial</td>
      <td>Loud Music/Party</td>
      <td>Club/Bar/Restaurant</td>
      <td>...</td>
      <td>0.98</td>
      <td>0.02</td>
      <td>16724.0</td>
      <td>15512.0</td>
      <td>464500.0</td>
      <td>40372.0</td>
      <td>-73.934802</td>
      <td>-73.902128</td>
      <td>40.716245</td>
      <td>40.690409</td>
    </tr>
    <tr>
      <th>21484</th>
      <td>56588661</td>
      <td>2023-01-21 23:59:10</td>
      <td>2023-01-22 02:50:54</td>
      <td>2.862222</td>
      <td>Weekend</td>
      <td>NYPD</td>
      <td>New York City Police Department</td>
      <td>Noise - Residential</td>
      <td>Loud Music/Party</td>
      <td>Residential Building/House</td>
      <td>...</td>
      <td>1.52</td>
      <td>0.08</td>
      <td>18756.0</td>
      <td>17033.0</td>
      <td>726500.0</td>
      <td>63739.0</td>
      <td>-73.962795</td>
      <td>-73.928137</td>
      <td>40.739446</td>
      <td>40.718088</td>
    </tr>
    <tr>
      <th>21485</th>
      <td>56591186</td>
      <td>2023-01-21 23:59:12</td>
      <td>2023-01-22 06:41:47</td>
      <td>6.709722</td>
      <td>Weekend</td>
      <td>NYPD</td>
      <td>New York City Police Department</td>
      <td>Illegal Parking</td>
      <td>Posted Parking Sign Violation</td>
      <td>Street/Sidewalk</td>
      <td>...</td>
      <td>0.95</td>
      <td>0.00</td>
      <td>16409.0</td>
      <td>14690.0</td>
      <td>636900.0</td>
      <td>44688.0</td>
      <td>-73.980729</td>
      <td>-73.951444</td>
      <td>40.705954</td>
      <td>40.687415</td>
    </tr>
    <tr>
      <th>21486</th>
      <td>56587053</td>
      <td>2023-01-21 23:59:24</td>
      <td>2023-01-22 06:24:40</td>
      <td>6.421111</td>
      <td>Weekend</td>
      <td>NYPD</td>
      <td>New York City Police Department</td>
      <td>Noise - Residential</td>
      <td>Loud Music/Party</td>
      <td>Residential Building/House</td>
      <td>...</td>
      <td>1.07</td>
      <td>0.00</td>
      <td>12184.0</td>
      <td>11194.0</td>
      <td>464500.0</td>
      <td>53617.0</td>
      <td>-73.887671</td>
      <td>-73.854413</td>
      <td>40.771808</td>
      <td>40.755854</td>
    </tr>
    <tr>
      <th>21487</th>
      <td>56590382</td>
      <td>2023-01-22 00:00:00</td>
      <td>2023-01-22 04:29:17</td>
      <td>4.488056</td>
      <td>Weekend</td>
      <td>NYPD</td>
      <td>New York City Police Department</td>
      <td>Noise - Residential</td>
      <td>Loud Music/Party</td>
      <td>Residential Building/House</td>
      <td>...</td>
      <td>2.40</td>
      <td>0.00</td>
      <td>21127.0</td>
      <td>19772.0</td>
      <td>454700.0</td>
      <td>52347.0</td>
      <td>-73.861920</td>
      <td>-73.824957</td>
      <td>40.861021</td>
      <td>40.830599</td>
    </tr>
  </tbody>
</table>
<p>21488 rows × 65 columns</p>
</div>
</div>
</div>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>